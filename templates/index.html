<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'common.css' %}">
    <link rel="stylesheet" href="{% static 'index.css' %}">
    <link rel="shortcut icon" href="{% static 'favicon.ico' %}" type="image/x-icon">
    <style>
        .status {
            display: flex;
            margin-top: 0px;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            flex-direction: row;
        }
        .div-1 {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }
    </style>
</head>
<body>
    <a href="{% url 'index' %}"><img src="https://i.ibb.co/7SwXPgX/nybb.jpg" alt="NYBB Logo" class="logo"></a>
    <h1>Genetic Odyssey</h1>
    <h2>All Teams</h2>

    <p>
        Start: <span id='start'>{{start}} </span><br>
        Over: <span id='over'>{{over}} </span><br>

        Remain: <span id="remaining_time">02:00</span><br>
        Countdown to Start: <span id="countdown_to_start">00:00:00</span>
    </p>

    <table id="teams">
        <tr>
            <th>Name</th>
            <th>Score</th>
            <th>Submission</th>
        </tr>
        {% for team in teams %}
            <tr>
                <td>{{team.name}}</td>
                <td>{{team.score}}</td>
                <td>{{team.time}}</td>
            </tr>
        {% endfor %}
    </table>

    <div style="display: flex; flex-direction: column; gap: 25px;">
        <div class="score-board" style="margin-bottom:0px;">
            <span>{{request.user}}</span>
            <span>Score: {{request.user.team.score}}</span>
        </div> 
        <div class="status">
            {% if request.user.team.quiz_1_status == True %}
                <a href="{% url 'quiz1' %}" class="button button-green">Issue 1: <br> Solved</a>{% else %}
                <a href="{% url 'quiz1' %}" class="button button-red">Issue 1: Unsolved</a>{% endif %}
            {% if request.user.team.quiz_2_status == True %}
                <a href="{% url 'quiz2' %}" class="button button-green">Issue 2: <br> Solved</a>{% else %}
                <a href="{% url 'quiz2' %}" class="button button-red">Issue 2: Unsolved</a>{% endif %}
            {% if request.user.team.quiz_3_status == True %}
                <a href="{% url 'quiz3' %}" class="button button-green">Issue 3: <br> Solved</a>{% else %}
                <a href="{% url 'quiz3' %}" class="button button-red">Issue 3: Unsolved</a>{% endif %}
            {% if request.user.team.quiz_4_status == True %}
                <a href="{% url 'quiz4' %}" class="button button-green">Issue 4: <br> Solved</a>{% else %}
                <a href="{% url 'quiz4' %}" class="button button-red">Issue 4: Unsolved</a>{% endif %}
            {% if request.user.team.quiz_5_status == True %}
                <a href="{% url 'quiz5' %}" class="button button-green">Issue 5: <br> Solved</a>{% else %}
                <a href="{% url 'quiz5' %}" class="button button-red">Issue 5: Unsolved</a>{% endif %}
            {% if request.user.team.quiz_6_status == True %}
                <a href="{% url 'quiz6' %}" class="button button-green">Issue 6: <br> Solved</a>{% else %}
                <a href="{% url 'quiz6' %}" class="button button-red">Issue 6: Unsolved</a>{% endif %}
        </div>
        <div class="div-1">
            <a href="{% url 'signin' %}" class="button button-blue">Sign In</a>
            <a href="{% url 'signout' %}" class="button button-blue">Sign Out</a>
        </div>    
    </div>

    <footer><span>&copy; 2024 | </span> <span><a href="#">NYBB - SUST</a></span></footer>

    {% comment %} <script>  
        // Function to update countdown timer to start time
        function updateCountdownToStart(start) {
            var start_time = new Date(start);

            console.log(start_time)
            var current_time = new Date();

            console.log(current_time)
            var remaining_time = start_time - current_time;
    
            if (remaining_time > 0) {
                var hours = Math.floor(remaining_time / (1000 * 60 * 60));
                var minutes = Math.floor((remaining_time % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((remaining_time % (1000 * 60)) / 1000);
    
                hours = (hours < 10 ? "0" : "") + hours;
                minutes = (minutes < 10 ? "0" : "") + minutes;
                seconds = (seconds < 10 ? "0" : "") + seconds;
    
                document.getElementById("countdown_to_start").textContent = hours + ":" + minutes + ":" + seconds;
            } else {
                document.getElementById("countdown_to_start").textContent = "00:00:00";
            }
        }
    
        // Call the functions with the start and end times from Django template
        window.onload = function() {
            var start_time = "{{ start }}";
            var end_time = "{{ over }}";

            console.log(start_time)
            
            updateCountdownToStart(start_time);
    
            // Update the remaining time and countdown every second
            setInterval(function() {
        
                updateCountdownToStart(start_time);
            }, 1000);
        };
    </script> {% endcomment %}
    
</body>
</html>
